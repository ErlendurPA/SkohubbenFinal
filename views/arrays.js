var allShoes = [
  (AFGB = {
    brand: "Nike",
    name: "Air Force 1'07",
    price: 100,
    src: "shoes/AFGB",
  }),
  (AFOW = {
    brand: "Nike",
    name: "Air Force 1'07",
    price: 200,
    src: "shoes/AFOW",
  }),
  (AFWH = {
    brand: "Nike",
    name: "Air Force 1'07",
    price: 300,
    src: "shoes/AFWH",
  }),
  (AFBL = {
    brand: "Nike",
    name: "Air Force 1'07",
    price: 400,
    src: "shoes/AFBL",
  }),
  (AFRB = {
    brand: "Nike",
    name: "Air Force 1 Low",
    price: 500,
    src: "shoes/AFRB",
  }),
  (AFBW = {
    brand: "Nike",
    name: "Air Force 1 Low",
    price: 600,
    src: "shoes/AFBW",
  }),
  (AFPB = {
    brand: "Nike",
    name: "Air Force 1 Low",
    price: 600,
    src: "shoes/AFPB",
  }),
  (AFGW = {
    brand: "Nike",
    name: "Air Force 1 Low",
    price: 600,
    src: "shoes/AFGW",
  }),
  (J1WH = {
    brand: "Jordan",
    name: "Jordan 1 mid",
    price: 1499,
    src: "shoes/J1WH",
  }),
  (J1BL = {
    brand: "Jordan",
    name: "Jordan 1 mid",
    price: 1499,
    src: "shoes/J1BL",
  }),
  (J1RB = {
    brand: "Jordan",
    name: "Jordan 1 mid",
    price: 1499,
    src: "shoes/J1RB",
  }),
  (JHPB = {
    brand: "Jordan",
    name: "Jordan 1 high",
    price: 1000,
    src: "shoes/JHPB",
  }),
  (JHRB = {
    brand: "Jordan",
    name: "Jordan 1 high",
    price: 1100,
    src: "shoes/JHRB",
  }),
  (JLOG = {
    brand: "Jordan",
    name: "Jordan 1 low originals",
    price: 1200,
    src: "shoes/JLOG",
  }),
  (J7SR = {
    brand: "Jordan",
    name: "Jordan 7 retro",
    price: 2349,
    src: "shoes/J7SR",
  }),
  (J1ZC = {
    brand: "Jordan",
    name: "Jordan 1 zom comfort 2",
    price: 1999,
    src: "shoes/J1ZC",
  }),
  (OGW = {
    brand: "Adidas",
    name: "Originals White",
    price: 1900,
    src: "shoes/OGW",
  }),
  (OGB = {
    brand: "Adidas",
    name: "Originals Blue",
    price: 2000,
    src: "shoes/OGB",
  }),
  (OGA = {
    brand: "Adidas",
    name: "Originals Black",
    price: 2100,
    src: "shoes/OGA",
  }),
  (OGP = {
    brand: "Adidas",
    name: "Originals Green",
    price: 2100,
    src: "shoes/OGG",
  }),
  (UBR = {
    brand: "Adidas",
    name: "Ultraboost Red",
    price: 2200,
    src: "shoes/UBR",
  }),
  (UBG = {
    brand: "Adidas",
    name: "Ultraboost White ",
    price: 2300,
    src: "shoes/UBW",
  }),
  (UBB = {
    brand: "Adidas",
    name: "Ultraboost Black",
    price: 2400,
    src: "shoes/UBB",
  }),
  (UBP = {
    brand: "Adidas",
    name: "Ultraboost Lucid Blue",
    price: 2400,
    src: "shoes/UBL",
  }),
  // CBU = { brand: "Crocs", name: "Blue Crocs", price: 100, src: "shoes/CBU" },
  // CGR = { brand: "Crocs", name: "Green Crocs", price: 200, src: "shoes/CGR" },
  // CRD = { brand: "Crocs", name: "Red Crocs", price: 300, src: "shoes/CRD" },
  // CBA = { brand: "Crocs", name: "Black Crocs", price: 400, src: "shoes/CBA" },
  // CWT = { brand: "Crocs", name: "White Crocs", price: 500, src: "shoes/CWT" },
  // CYZ = { brand: "Crocs", name: "Jesus Crocs", price: 600, src: "shoes/CYZ" },
  // CMQ = { brand: "Crocs", name: "McQueen Crocs", price: 600, src: "shoes/CMQ" },
  // CFN = { brand: "Crocs", name: "Fortnite Crocs", price: 600, src: "shoes/CFN" },
];
var shoppingcart = [
  (AFGB = {
    brand: "Nike",
    name: "Air Force 1'07",
    price: 100,
    src: "shoes/AFGB",
    amount: 0,
  }),
  (AFOW = {
    brand: "Nike",
    name: "Air Force 1'07",
    price: 200,
    src: "shoes/AFOW",
    amount: 0,
  }),
  (AFWH = {
    brand: "Nike",
    name: "Air Force 1'07",
    price: 300,
    src: "shoes/AFWH",
    amount: 0,
  }),
  (AFBL = {
    brand: "Nike",
    name: "Air Force 1'07",
    price: 400,
    src: "shoes/AFBL",
    amount: 0,
  }),
  (AFRB = {
    brand: "Nike",
    name: "Air Force 1 Low",
    price: 500,
    src: "shoes/AFRB",
    amount: 0,
  }),
  (AFBW = {
    brand: "Nike",
    name: "Air Force 1 Low",
    price: 600,
    src: "shoes/AFBW",
    amount: 0,
  }),
  (AFPB = {
    brand: "Nike",
    name: "Air Force 1 Low",
    price: 600,
    src: "shoes/AFPB",
    amount: 0,
  }),
  (AFGW = {
    brand: "Nike",
    name: "Air Force 1 Low",
    price: 600,
    src: "shoes/AFGW",
    amount: 0,
  }),
  (J1WH = {
    brand: "Jordan",
    name: "Jordan 1 mid",
    price: 1499,
    src: "shoes/J1WH",
    amount: 0,
  }),
  (J1BL = {
    brand: "Jordan",
    name: "Jordan 1 mid",
    price: 1499,
    src: "shoes/J1BL",
    amount: 0,
  }),
  (J1RB = {
    brand: "Jordan",
    name: "Jordan 1 mid",
    price: 1499,
    src: "shoes/J1RB",
    amount: 0,
  }),
  (JHPB = {
    brand: "Jordan",
    name: "Jordan 1 high",
    price: 1000,
    src: "shoes/JHPB",
    amount: 0,
  }),
  (JHRB = {
    brand: "Jordan",
    name: "Jordan 1 high",
    price: 1100,
    src: "shoes/JHRB",
    amount: 0,
  }),
  (JLOG = {
    brand: "Jordan",
    name: "Jordan 1 low originals",
    price: 1200,
    src: "shoes/JLOG",
    amount: 0,
  }),
  (J7SR = {
    brand: "Jordan",
    name: "Jordan 7 retro",
    price: 2349,
    src: "shoes/J7SR",
    amount: 0,
  }),
  (J1ZC = {
    brand: "Jordan",
    name: "Jordan 1 zom comfort 2",
    price: 1999,
    src: "shoes/J1ZC",
    amount: 0,
  }),
  (OGW = {
    brand: "Adidas",
    name: "Originals White",
    price: 1900,
    src: "shoes/OGW",
    amount: 0,
  }),
  (OGB = {
    brand: "Adidas",
    name: "Originals Blue",
    price: 2000,
    src: "shoes/OGB",
    amount: 0,
  }),
  (OGA = {
    brand: "Adidas",
    name: "Originals Black",
    price: 2100,
    src: "shoes/OGA",
    amount: 0,
  }),
  (OGP = {
    brand: "Adidas",
    name: "Originals Green",
    price: 2100,
    src: "shoes/OGG",
    amount: 0,
  }),
  (UBR = {
    brand: "Adidas",
    name: "Ultraboost Red",
    price: 2200,
    src: "shoes/UBR",
    amount: 0,
  }),
  (UBG = {
    brand: "Adidas",
    name: "Ultraboost White ",
    price: 2300,
    src: "shoes/UBW",
    amount: 0,
  }),
  (UBB = {
    brand: "Adidas",
    name: "Ultraboost Black",
    price: 2400,
    src: "shoes/UBB",
    amount: 0,
  }),
  (UBP = {
    brand: "Adidas",
    name: "Ultraboost Lucid Blue",
    price: 2400,
    src: "shoes/UBL",
    amount: 0,
  }),
];

if (sessionStorage.getItem("wholeCart")) {
  shoppingcart = JSON.parse(sessionStorage.getItem("wholeCart"));
}

function onstart() {
  for (i = 0; i < 24; i++) {
    document.getElementById("exRows").style.display = "block";
    document.getElementById("product" + i).innerHTML +=
      '<button class="selector" type="button" onclick="shoeClicked(event)">' +
      '<img class="shop-item-image" src=' +
      allShoes[i].src +
      ".png" +
      ' alt="placeholder">' +
      "</button>" +
      '<div class="description">' +
      '<h3 class="shop-item-title">' +
      allShoes[i].name +
      "</h3>" +
      '<h3 class="shop-item-price">$' +
      allShoes[i].price +
      "</h3>" +
      '<button class="btn btn-primary shop-item-button" type="button" onclick="addToCartClicked(event)">' +
      '<img src="IMGS/Handlevogn_1utkast.svg" alt="Handlevogn_1utkast" width="25px">' +
      "</button>" +
      "</div>";
  }
  cartCounter();
}

//
//
//  Filter |||
//         vvv
//

function clear() {
  document.getElementById("exRows").style.display = "none";
  for (i = 0; i < 8; i++) {
    document.getElementById("product" + i).innerHTML = "";
  }
  cartCounter();
}

function nikesOnly() {
  clear();
  window.location.href = "shopHome.html";
  for (i = 0; i < 8; i++) {
    document.getElementById("product" + i).innerHTML +=
      '<button class="selector" type="button" onclick="shoeClicked(event)">' +
      '<img class="shop-item-image" src=' +
      allShoes[i].src +
      ".png" +
      ' alt="placeholder">' +
      "</button>" +
      '<div class="description">' +
      '<h3 class="shop-item-title">' +
      allShoes[i].name +
      "</h3>" +
      '<h3 class="shop-item-price">$' +
      allShoes[i].price +
      "</h3>" +
      '<button class="btn btn-primary shop-item-button" type="button" onclick="addToCartClicked(event)">' +
      '<img src="IMGS/Handlevogn_1utkast.svg" alt="Handlevogn_1utkast" width="25px">' +
      "</button>" +
      "</div>";
  }
}
function jordansOnly() {
  clear();
  window.href = "shopHome.html";
  for (i = 8; i < 16; i++) {
    document.getElementById("product" + (i - 8)).innerHTML +=
      '<button class="selector" type="button" onclick="shoeClicked(event)">' +
      '<img class="shop-item-image" src=' +
      allShoes[i].src +
      ".png" +
      ' alt="placeholder">' +
      "</button>" +
      '<div class="description">' +
      '<h3 class="shop-item-title">' +
      allShoes[i].name +
      "</h3>" +
      '<h3 class="shop-item-price">$' +
      allShoes[i].price +
      "</h3>" +
      '<button class="btn btn-primary shop-item-button" type="button" onclick="addToCartClicked(event)">' +
      '<img src="IMGS/Handlevogn_1utkast.svg" alt="Handlevogn_1utkast" width="25px">' +
      "</button>" +
      "</div>";
  }
}
function adidasOnly() {
  clear();
  window.href = "shopHome.html";
  for (i = 16; i < 24; i++) {
    document.getElementById("product" + (i - 16)).innerHTML +=
      '<button class="selector" type="button" onclick="shoeClicked(event)">' +
      '<img class="shop-item-image" src=' +
      allShoes[i].src +
      ".png" +
      ' alt="placeholder">' +
      "</button>" +
      '<div class="description">' +
      '<h3 class="shop-item-title">' +
      allShoes[i].name +
      "</h3>" +
      '<h3 class="shop-item-price">$' +
      allShoes[i].price +
      "</h3>" +
      '<button class="btn btn-primary shop-item-button" type="button" onclick="addToCartClicked(event)">' +
      '<img src="IMGS/Handlevogn_1utkast.svg" alt="Handlevogn_1utkast" width="25px">' +
      "</button>" +
      "</div>";
  }
}
function crocsOnly() {
  clear();
  window.href = "shopHome.html";
  for (i = 24; i < 32; i++) {
    document.getElementById("product" + (i - 24)).innerHTML +=
      '<button class="selector" type="button" onclick="shoeClicked(event)">' +
      '<img class="shop-item-image" src=' +
      allShoes[i].src +
      ".png" +
      ' alt="placeholder">' +
      "</button>" +
      '<div class="description">' +
      '<h3 class="shop-item-title">' +
      allShoes[i].name +
      "</h3>" +
      '<h3 class="shop-item-price">$' +
      allShoes[i].price +
      "</h3>" +
      '<button class="btn btn-primary shop-item-button" type="button" onclick="addToCartClicked(event)">' +
      '<img src="IMGS/Handlevogn_1utkast.svg" alt="Handlevogn_1utkast" width="25px">' +
      "</button>" +
      "</div>";
  }
}

//
//
//  For selected.html |||
//                    vvv
//

let x = 0;

function shoeClicked(event) {
  let shoe = event.target.getAttribute("src");
  console.log(shoe);
  for (i = 0; i < allShoes.length; i++) {
    if (shoe == allShoes[i].src + ".png") {
      console.log(i);
      var x = i;
      console.log(x);
      sessionStorage.setItem("x", x);
    }
  }
  window.location.href = "selected.html";
  cartCounter();
}

function selectedLoad() {
  let x = sessionStorage.getItem("x");
  for (i = 1; i < 6; i++) {
    document.getElementById("xshoeImg" + i).src = "placeholder.png";
    document.getElementById("xshoeImg" + i).alt = "placeholder";
  }
  document.getElementById("xshoeTitle").innerHTML = "";
  document.getElementById("xshoePrice").innerHTML = "";

  console.log(x);
  document.getElementById("xshoeImg1").src = allShoes[x].src + ".png";
  for (i = 2; i < 6; i++) {
    document.getElementById("xshoeImg" + i).src = allShoes[x].src + i + ".png";
  }
  document.getElementById("xshoeTitle").innerHTML = allShoes[x].name;
  document.getElementById("xshoePrice").innerHTML = allShoes[x].price + "kr";
  cartCounter();
}

function slideNext() {
  let src1 = document.getElementById("xshoeImg1").src;
  let src2 = document.getElementById("xshoeImg2").src;
  let src3 = document.getElementById("xshoeImg3").src;
  let src4 = document.getElementById("xshoeImg4").src;
  let src5 = document.getElementById("xshoeImg5").src;
  document.getElementById("xshoeImg1").src = src5;
  document.getElementById("xshoeImg2").src = src1;
  document.getElementById("xshoeImg3").src = src2;
  document.getElementById("xshoeImg4").src = src3;
  document.getElementById("xshoeImg5").src = src4;
}

function slidePrev() {
  let src1 = document.getElementById("xshoeImg1").src;
  let src2 = document.getElementById("xshoeImg2").src;
  let src3 = document.getElementById("xshoeImg3").src;
  let src4 = document.getElementById("xshoeImg4").src;
  let src5 = document.getElementById("xshoeImg5").src;
  document.getElementById("xshoeImg1").src = src2;
  document.getElementById("xshoeImg2").src = src3;
  document.getElementById("xshoeImg3").src = src4;
  document.getElementById("xshoeImg4").src = src5;
  document.getElementById("xshoeImg5").src = src1;
}

//
//
//  For shoppingcart.html |||
//                        vvv
//

var y = 0;

function addToCartClicked(event) {
  let chosen =
    event.target.parentElement.parentElement.parentElement.children[0].children[0].getAttribute(
      "src"
    );
  console.log(chosen);
  for (i = 0; i < allShoes.length; i++) {
    if (chosen == allShoes[i].src + ".png") {
      console.log(i);
      shoppingcart[i].amount += 1;
      sessionStorage.setItem("wholeCart", JSON.stringify(shoppingcart));
    }
  }
  window.alert("Added to cart!");
  cartCounter();
}

function selectedAddToCartClicked() {
  let x = sessionStorage.getItem("x");
  shoppingcart[x].amount += 1;
  sessionStorage.setItem("wholeCart", JSON.stringify(shoppingcart));
  window.alert("Added to cart!");
  cartCounter();
}

var num = 1;

function addingToCart() {
  if (sessionStorage.getItem("wholeCart")) {
    shoppingcart = JSON.parse(sessionStorage.getItem("wholeCart"));
    console.log(shoppingcart);
  }

  for (i = 0; i < shoppingcart.length; i++) {
    console.log(shoppingcart[i].amount);
    if (shoppingcart[i].amount >= 1) {
      document.getElementById("cart-items").innerHTML +=
        '<div class="cart-row">' +
        '<img class ="cart-item-image"  id="cart-item-' +
        i +
        '-image">' +
        '<h3 class ="cart-item-title"  id="cart-item-' +
        i +
        '-title"></h3>' +
        '<h3 class ="cart-item-price" id="cart-item-' +
        i +
        '-price"></h3>' +
        '<div class ="amount-changers">' +
        '<button class="btn btn-primary amount-changer" type="button" onclick="amountChangerClicked(event)">-</button>' +
        '<h3 class ="cart-item-amount" id="cart-item-' +
        i +
        '-amount"></h3>' +
        '<button class="btn btn-primary amount-changer" type="button" onclick="amountChangerClicked(event)">+</button>' +
        "</div>" +
        "</div>";

      document.getElementById("cart-item-" + i + "-image").src =
        shoppingcart[i].src + ".png";
      document.getElementById("cart-item-" + i + "-title").innerHTML =
        shoppingcart[i].name;
      document.getElementById("cart-item-" + i + "-price").innerHTML =
        shoppingcart[i].price * shoppingcart[i].amount + "kr";
      document.getElementById("cart-item-" + i + "-amount").innerHTML =
        shoppingcart[i].amount;
    }
  }
  var total = 0;
  for (i = 0; i < shoppingcart.length; i++) {
    total += shoppingcart[i].price * shoppingcart[i].amount;
    document.getElementById("cart-total-price").innerHTML =
      "Total " + total + "kr";
  }
  cartCounter();
}

function amountChangerClicked(event) {
  let chosen =
    event.target.parentElement.parentElement.children[0].getAttribute("src");
  console.log(chosen);
  for (i = 0; i < allShoes.length; i++) {
    if (chosen == allShoes[i].src + ".png") {
      console.log(i);
      if (event.target.innerHTML == "-") {
        shoppingcart[i].amount -= 1;
      } else if (event.target.innerHTML == "+") {
        shoppingcart[i].amount += 1;
      }
      sessionStorage.setItem("wholeCart", JSON.stringify(shoppingcart));
    }
  }
  window.location.href = "shoppingcart.html";
  cartCounter();
}

function cartCounter() {
  var counter = 0;
  let wholecart = JSON.parse(sessionStorage.getItem("wholeCart"));
  if (wholecart.length == null) {
    return;
  }
  else {
    for (i = 0; i < wholecart.length; i++) {
      counter += wholecart[i].amount;
    }
    if (counter > 0) {
      document.getElementById("cartCounter").innerHTML = counter;
    }
    else if (counter == 0) {
      document.getElementById("cartCounter").style = "display: none";
    }
  }
}

//
//
//  For userPage.html |||
//                    vvv
//



function onUserPageLoad() {
  loggedIn = JSON.parse(localStorage.getItem("loggedIn"));
  localUsername = localStorage.getItem("localUsername");
  if (loggedIn != true) {
    document.getElementById("listContainer").innerHTML =
      '<div class="shoppinglistTitle">' +
      '<h1>You are not logged in</h1>' +
      '</div>' +
      '<div class="shoppinglistTitle">' +
      '<input class="loginDetails" id="usernameL" type="text" name="username" placeholder="username" >' +
      '<input class="loginDetails" id="passwordL" type="password" name="password" placeholder="password" >' +
      '<button onclick="logIn()">LOGIN</button>' +
      '</div>' +
      '<div class="shoppinglistTitle">' +
      '<button onclick="signUpOption()">SIGN UP?</button>' +
      '</div>'
  } else if (loggedIn == true) {
    document.getElementById("listContainer").innerHTML =
      '<div class="shoppinglistTitle">' +
      '<h1>' + localUsername + '</h1>' +
      '</div>' +
      '<div class="selectBack">' +
      '<div class="pfpdiv">' +
      '<img id="pfp" src="IMGS/defaultUser.jpg" alt="placeholder" />' +
      '</div>' +
      '<div class="userInfo">' +
      '<button onclick="logout()">Log out</button>' +
      ' <div class="moreInfo">' +
      '</div>' +
      '</div>' +
      '</div>'
  }
  else {
    document.getElementById("listContainer").innerHTML = 'error';
  }
}

function logout() {
  localStorage.setItem("loggedIn", false);
  window.location.href = "/userPage.html";
}

async function logIn() {
  console.log("Logging in");
  let username = document.getElementById("usernameL").value;
  let password = document.getElementById("passwordL").value;
  let user = { username: username, password: password };
  localStorage.setItem("localUsername", username);

  try {
    const response = await fetch("/login", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify(user),
    });

    if (response.ok) {
      const data = await response.json();
      console.log(data.status); // 'LOGGEDIN'
      // Perform actions for successful login, e.g., redirect to another page
      window.location.href = "/userPage.html"; // Redirect to the user page
      localStorage.setItem("loggedIn", true);
    } else {
      const errorData = await response.json();
      console.log(errorData.error);
      // Handle error response, e.g., display an error message to the user
    }
  } catch (error) {
    console.error(error);
    // Handle fetch error
  }

  console.log("Logged in");
}


function signUpOption() {
  document.getElementById("listContainer").innerHTML =
    '<div class="shoppinglistTitle">' +
    '<h1>Sign Up</h1>' +
    '</div>' +
    '<div class="shoppinglistTitle">' +
    '<input type="text" name="username" placeholder="username" class="loginDetails" id="username">' +
    '<input type="password" name="password" placeholder="password" class="loginDetails" id="password">' +
    '<button onclick="signUp()">Submit</button>' +
    '</div>' +
    '<div class="shoppinglistTitle">' +
    '<button onclick="onUserPageLoad()">LOGIN</button>' +
    '</div>'
}

async function signUp() {
  console.log("signUp");
  let username = document.getElementById("username").value;
  let password = document.getElementById("password").value;
  let user = { username: username, password: password };
  console.log(user);
  await fetch("/register", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
    },
    body: JSON.stringify(user),
  });
}

function cartToBase() {
  let wholecart = JSON.parse(sessionStorage.getItem("wholeCart"));
  let username = localStorage.getItem("localUsername");
  let cart = { username: username, cart: wholecart };
  console.log(cart);
  fetch("/cart", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
    },
    body: JSON.stringify(cart),
  });
}